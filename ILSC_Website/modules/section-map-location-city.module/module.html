<section class="section section-map {{ module.add_top_bottom_pad }}">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
        {% inline_rich_text field="title_address" value="{{ module.title_address }}" %}
        
				{% for item in module.location_group %}
          {% set mapVal = item.map_coordinates|urlencode %}
          <div>
            {{ item.location_address }} <span class="map-url">&nbsp;<a href="https://www.google.com/maps/search/?api=1&query={{mapVal}}" target="_blank"><i class="fas fa-external-link-alt"></i></a></span>
          </div>
         {% endfor %}
			</div>
		</div>
	</div>
	<div id="google-map" >
		{% if module.main_image.src %}
      {% set sizeAttrs = 'width="{{ module.main_image.width|escape_attr }}" height="{{ module.main_image.height|escape_attr }}"' %}
      {% if module.main_image.size_type == 'auto' %}
        {% set sizeAttrs = 'width="{{ module.main_image.width|escape_attr }}" height="{{ module.main_image.height|escape_attr }}" style="max-width: 100%; height: auto;"' %}
      {% elif module.main_image.size_type == 'auto_custom_max' %}
        {% set sizeAttrs = 'width="{{ module.main_image.max_width|escape_attr }}" height="{{ module.main_image.max_height|escape_attr }}" style="max-width: 100%; height: auto;"' %}
      {% endif %}
       {% set loadingAttr = module.main_image.loading != 'disabled' ? 'loading="{{ module.main_image.loading|escape_attr }}"' : '' %}
      <img src="{{ module.main_image.src|escape_url }}" alt="{{ module.main_image.alt|escape_attr }}" {{ loadingAttr }} {{ sizeAttrs }}>
    {% endif %}
	</div>
  
</section>

{#
  <script async defer type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJgaVAafWtWZEUOcApvFg0zTh4GrK2W2E&loading=async&callback=initMap"></script>

  <script type="text/javascript">
              // When the window has finished loading create our google map below
    
    window.gm_authFailure = function() {
      // remove the map div or maybe call another API to load map
     // maybe display a useful message to the user
     $('#google-map').remove();
     $(".section-map").addClass('no-map');
     $(".section-map .map-url").show(); 
   
  }

    function initMap() {
      // Basic options for a simple Google Map
      // For more options see: https://developers.google.com/maps/documentation/javascript/reference#MapOptions
      // 

      var locations = [];
      {% for item in module.location_group %}
        locations.push([{{ item.map_coordinates }}]);
      {% endfor %}

      var mapOptions = {
        // How zoomed in you want the map to start at (always required)
        zoom: {{ module.map_zoom }},
        disableDefaultUI: true,

        {% for item in module.location_group %}
        // The latitude and longitude to center the map (always required)
            {% if module.location_group|length > 1 %}
              {% if item.center_position %}
                center: new google.maps.LatLng({{ item.map_coordinates }}), // New York
              {% endif %}
             {% else %}
                 center: new google.maps.LatLng({{ item.map_coordinates }}), // New York
             {% endif %}
        {% endfor %}
        // How you would like to style the map. 
        // This is where you would paste any style found on Snazzy Maps.
        styles: [{"featureType":"water","elementType":"geometry","stylers":[{"color":"#e9e9e9"},{"lightness":17}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":20}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#ffffff"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#ffffff"},{"lightness":29},{"weight":0.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":16}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":21}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#dedede"},{"lightness":21}]},{"elementType":"labels.text.stroke","stylers":[{"visibility":"on"},{"color":"#ffffff"},{"lightness":16}]},{"elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#333333"},{"lightness":40}]},{"elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#f2f2f2"},{"lightness":19}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#fefefe"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke","stylers":[{"color":"#fefefe"},{"lightness":17},{"weight":1.2}]}]
      };

      // Get the HTML DOM element that will contain your map 
      // We are using a div with id="map" seen below in the <body>
      var mapElement = document.getElementById('google-map');

      // Create the Google Map using our element and options defined above
      var map = new google.maps.Map(mapElement, mapOptions);

      // Let's also add a marker while we're at it
      var marker, i;

      for (i = 0; i < locations.length; i++) {
        marker = new google.maps.Marker({
          position: new google.maps.LatLng(locations[i][0], locations[i][1]),
          map: map,
          title: 'ILSC!',
          icon : 'https://f.hubspotusercontent10.net/hubfs/5020112/template-resources/images/internal/icons/ilsc_marker.png'
        });
      }
    }
  </script>
      
#]